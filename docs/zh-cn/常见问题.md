# 常见问题

?>你可以使用浏览器的搜索功能 `F3`，输入关键词在本页面上进行查找。

## 检查以下信息

当你遇到问题时，请首先检查下面的原因：

1. 如果浏览器不是 Chrome，请使用 Chrome 浏览器。
2. 如果 Chrome 浏览器不是最新版本，请更新浏览器。
3. 如果本扩展程序不是最新版本，请更新到最新版本。最新版本号：![version](https://img.shields.io/github/v/release/xuejianxianzun/PixivBatchDownloader)
4. 可能是网络连接不畅，请检查网络连接。国内用户建议使用梯子，并且使用全局代理模式。
5. 系统磁盘的剩余空间可能不足。请尝试清理系统磁盘空间，然后重新启动浏览器，继续未完成的下载。

## 检查其他原因

1. 如果你不清楚某些功能怎么使用，请参考本 wiki 里的相关内容。
2. 查看 [安装之后的设置](zh-cn/安装之后) 页面，检查一些原因。
3. 查看本页面上的帮助信息。
4. 如果问题仍然不能解决，请查看 [联系我](zh-cn/联系我) 页面。

-------------

## 怎么建立文件夹

在命名规则里使用斜线 `/` ，斜线前面的部分会作为文件夹的名字。

如 `{p_title}/{id}-{tags}-{user}` 会使用页面标题建立一个文件夹。

## 怎么把画师的作品放到同一个文件夹里

怎么把画师的作品放在一起？

在命名规则里使用画师名字作为文件夹名字就可以了。例如：

```
{user}/{id}
```

## 文件下载到了哪里

文件/图片保存位置：下载的文件保存在浏览器的下载目录里。

## 能不能把文件保存到浏览器下载目录之外

不能，这是浏览器的限制。

下载器自动保存文件时，只能把文件保存到浏览器的下载目录里，这是浏览器的安全策略。

## 怎么修改下载位置

如果你不想让文件保存到浏览器的下载目录里，那么你只能在浏览器的设置中，修改下载文件夹的位置。

浏览器设置-高级-下载内容-位置

`chrome://settings/downloads`

此外还有一个变通的方法。你可以通过设置命名规则，把文件存放到下载目录里的一个子目录里。在下载完成后，你可以把这个子目录里的内容移动到其他位置。

例如： `pixiv/{user}/{id}`

## 为什么抓取到的文件数量比作品数量多

有时候在抓取完成后你可能会看到像这样的提示：

```
共有 10 个作品
共有 20 个文件
```

这是因为有些作品可能包含多个图片。每个图片是一个文件，所以文件数量比作品数量多是很正常的。

## 下载后的文件名不对

*文件名异常/文件名乱码*

有些用户可能看到下载后的文件名是一串不知道什么意思的字符，类似这样：

![](./images/20211112162142.jpg)

```
7dc64752-0616-448d-99ce-4676c501b503.png
e3852d43-4a9f-4156-abda-544eff38ce3f.jpg
```

这是因为其他扩展程序修改了下载器的文件的名字，导致了这个问题。

你可以尝试依次禁用其他有下载功能的扩展程序。然后使用本扩展程序，观察问题是否解决。通过这种方法来找到有冲突的扩展程序。

冲突的扩展程序通常是管理文件下载的，例如 Chrono 下载管理器，或者是一些下载软件的扩展程序、或者是截图类的扩展程序。

从技术上来看，如果一个扩展程序在代码中使用了 `onDeterminingFilename` 事件，就有可能与下载器产生冲突。

?>下载器没有使用这个事件，也不会影响其他扩展程序的文件名。

## 是否支持断点续传

支持断点续传。下载时如果页面崩溃或者关闭了页面，之后可以打开这个页面继续下载。

## 怎么不下载重复文件

怎么不下载以前已经下载过的作品？

启用选项“不下载重复文件”。可查看  [不下载重复文件](/zh-cn/设置-其他?id=不下载重复文件) 部分。

在某些情况下，你也可以考虑使用增量更新，避免下载以前下载过的文件。可查看“使用技巧”页面的“增量更新”部分。

## 下载很慢

下载慢、下载没速度怎么办？

这主要是国内用户会遇到的问题，推荐使用靠谱的代理/翻墙软件，比如 ssr、v2ray、clash 等，使用稳定的路线。并且代理规则选择**全局代理**。（**开启全局代理可以提高下载速度**）

还有另一个办法，就是用“复制 url”功能复制图片网址，使用迅雷、IDM 等软件下载。但是这些软件下载时无法对文件重命名。

## 动图下载很慢

动图下载慢首先请参考上一条。另外动图下载慢有时候也是正常的。

1. 动图的体积本身就很大，下载会慢一些、
2. pixiv 动图的本质是 zip 文件。如果选择了动图保存格式为“webm”或者“APNG”或者“gif”，那么下载器还会对 zip 文件进行转码，这也会花费一些时间。
3. 可能是页面被遮挡住了。请参考：[转换动图时保持页面不被完全遮挡](/zh-cn/使用技巧?id=转换动图时保持页面不被完全遮挡)

## 任务卡住怎么办

这一般是网络问题，网络情况越差，越容易遇到这个问题。

如果你在抓取任务时就卡住，可以尝试等待一段时间，看过一段时间之后是否能够继续抓取。如果不能，建议刷新页面重新抓取。

如果在下载时卡住，可以先暂停任务然后点击开始下载；或者关闭页面，之后再打开这个页面，继续下载。

?>如果你的网络情况比较差，可以把下载线程设置的小一些，减小卡住的几率。

## 下载卡住时会自动重试吗

会。

当网络状况较差时，下载可能会因为超时或者网络断开而卡住。本程序会自动重试下载出错的文件。

## 一直卡住，无法下载到任何图片

首先检查网络问题，如果网络没问题（可以正常访问 Pixiv，网速也很快），那么你可以检查一下系统盘（一般是 C 盘）剩余空间。

如果系统盘剩余空间比较小，Chrome 可能会阻止一些较大的 xhr 请求，导致下载一直失败。请清理一下空间再尝试下载。这个原因是由 Reinford 找出来的。

*备注：在这种情况下，Chrome 不会阻止 fetch 请求*

## 下载到的图片是损坏的

下载的图片只能显示一部分/一半，剩余部分没有图像。

这可能是下载时网络出现问题，图片加载到一半之后失败了。请重新下载损坏的图片/作品。

如果重新下载后还是损坏的，可能是这个图片存在缓存。请清除浏览器的缓存之后，刷新页面重新下载这个作品。

## 下载进度条变成红色是怎么回事

这表示这个进度条上的文件下载出现了错误，下载器会尝试重新下载它。

你不需要做出处理。

## 下载失败：USER_CANCELED

如果出现这样的错误提示，注意有没有出现另存为对话框。如果有，参考下一条。如果没有，请查看“联系我”页面，报告问题。

## 下载时弹出另存为对话框

请确认你在浏览器设置里**关闭**了“下载前询问每个文件的保存位置”。

如果关闭了这个选项，仍然会出现另存为对话框，原因是下载的文件里有重复的文件名。如果带 `{id}` 标记应该不会重名，其他时候记得带序号。比如作品 id 78279423，有三张图片，`{id}` 标记会带序号，这样就不会重名：

```
78279423_p0.jpg
78279423_p1.jpg
78279423_p2.jpg
```

如果不带序号，就会重名：

```
78279423.jpg
78279423.jpg
78279423.jpg
```

当命名规则里没有 `{id}` 或者 `{p_num}`，则要留意是否会出现重名问题。

## 为什么在搜索页面不会自动开始下载

你可以关闭“预览搜索页面的筛选结果”，并且启用“自动开始下载”，这样就可以自动开始下载了。

为什么启用了“预览搜索页面的筛选结果”就不会自动开始下载了呢？请查看这个选项的说明。

[预览搜索页面的筛选结果](zh-cn/设置-其他?id=预览搜索页面的筛选结果)

## 离线安装之后，浏览器启动时会出现提示

如果你离线安装了本程序，当浏览器启动时，可能会在右上角提示：请停止以开发者模式运行的扩展程序。

![](./images/2019-10-18_17-12-00.jpg)

>Chrome 84 版本之后没有这个弹窗了。但是 Edge 浏览器目前还有。

如果你想消除这个提示，以下提供一些办法：

1. 如果你安装有火绒杀毒软件，你可以使用它的屏蔽弹窗功能，屏蔽这个弹窗。

![](./images/2019-10-18_17-17-00.png)

注意只选择这个弹窗，不要把整个 chrome 都屏蔽了。

来源：[一届书生](https://www.cnblogs.com/52dxer/p/11067617.html ':target=_blank')

*在线安装本扩展不会出现弹窗警告。*

## Date format error!

如果启用了选项“设置投稿时间”，需要输入起始时间和结束时间。

如果输入的时间不能被解析为有效的时间，就会出现警告信息：`Date format error!`

## 无权访问某个作品

这是因为在获取某个作品时出现了无法处理的错误。

这是一个网络请求的错误，可能这个作品是私密的作品，或者只是单纯的网络问题。

你可以打开这个 id 的作品页面，如果它是正常的，你可以在这个页面直接下载它。

## 下载（抓取）按钮不显示

这可能是某些设置项的值有误，导致下载器出错。

你可以尝试打开下载面板-“其他”选项卡-管理设置-重置设置，然后刷新页面。

## 如何下载 ID 列表

如果你有作品的 id 列表，想根据 id 列表进行下载，需要打开 Pixiv 主页，然后打开下载器面板，可以看到这个按钮：

*输入id进行抓取*

点击这个按钮会出现一个输入框，把 id 列表复制进去就可以开始抓取了。

## 怎么停止抓取

怎么停止/中止/中断抓取？

目前没有控制按钮可以停止抓取。你可以刷新页面来强制停止抓取。

## 浏览器启动时卡住

Chrome很卡/卡顿/Chrome启动无响应/卡一会儿/浏览器卡顿/浏览器很卡

这可能是你的下载记录太多导致的。你可以在“清理浏览数据”界面查看下载记录的数量：

![](./images/20211112175156.png)

下载记录太多可能会导致浏览器卡顿，特别是浏览器刚启动时，以及打开下载管理页面时。

一般来说，如果下载记录的数量超过 10,000 个，你就可以清理了。

如果清理下载记录之后，问题依然没有解决，请考虑卸载和重装浏览器。

## 怎么分批下载

分批下载/分批抓取

在一些页数较多的页面里，如果你预计到抓取结果太多，可以考虑分批进行抓取和下载。

例如：

1. 在第 1 页，设置“抓取页数”为 100，然后开始抓取和下载。
2. 下载完成后，跳转到第 101 页，然后再次抓取 100 页。因为下载器会从当前页面开始计算页数，所以这样可以抓取 101 - 200 页。
3. 以此类推。

## 最多只能抓取 1000 页怎么办

搜索页面不能抓取所有作品怎么办？目前没有能够直接解决这个的办法，需要你多花点时间来手动解决。

有些 tag 的搜索结果很多，例如：

https://www.pixiv.net/tags/%E8%83%8C%E6%99%AF/artworks

“背景” tag 现在有 172,734 个作品。一页显示 60 个作品，总页数接近 2900 页。

但是你可能只能查看到 1000 页。当你位于第 1000 页时。底部的页码也到头了，没有后续的页码：

https://www.pixiv.net/tags/%E8%83%8C%E6%99%AF/artworks?p=1000https://www.pixiv.net/tags/%E8%83%8C%E6%99%AF/artworks?p=1000

![](./images/20220304162133.png)

抓取不完了，这是怎么回事呢？

1. 这是 pixiv 的限制，下载器无法破解。
2. pixiv 普通用户最多可以查看 1000 页，pixiv 高级会员最多可以查看 5000 页。
3. 你能够查看到多少页，下载器也就能下载到多少页。

**怎么解决这个问题**？以下是一些可行的方法：

- 方法 1：修改排序方式来抓取更多作品

![](./images/20220304162041.jpg)

默认情况下搜索结果的排序方式是从新到旧。你可以先正常抓取和下载 1000（或者 5000）页，下载完成之后，在第一页点击“按旧排序”，这样搜索结果的排序方式是从旧到新，这样你就能够下载到更多的作品了，最多可以下载到 2000（或者 10000）页的作品。但是如果这样还是不能下载到所有作品，那就需要考虑其他办法了。

- 方法 2：使用时间段筛选

你可以在搜索页面点击“搜索条件”，然后设置“时间”选项为“指定时间”。

![](./images/20220304162104.png)

例如，你可以设置时间范围为某一年，然后查看和下载这一年里发表的作品。

下载完成后，再搜索另一年里发表的作品，并下载它们。以此类推。

- 方法 3：购买 pixiv 高级会员（premium）

因为 pixiv 高级会员（premium）可以查看 5000 页，所以不容易遇到这个问题。相比之下，普通用户只能查看 1000 页，遇到这个问题的几率就比较高。

